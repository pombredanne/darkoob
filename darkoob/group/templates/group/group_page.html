{% extends "base/profile_base.html" %}

{% load staticfiles %}
{% load thumbnail %}

{% block css %}
{{ block.super }}
<link rel="stylesheet" type="text/less" href="{% static "/static/css/home_style.less" %}">
<link rel="stylesheet" type="text/less" href="{% static "/static/css/page.less" %}">
{% endblock css %}

{% block js %}
{{ block.super }}
{% endblock js %}

{% block title %}Group{% endblock title %}

{% block sidebar %}
<div class="row-fluid">
  <div class="span12">
    <ul class="nav nav-tabs nav-stacked left-nav">
      <li>
        <a href="{% url 'group:members' %}"><i class="icon-user"></i> Members<i class="icon-chevron-right" style="float:right"></i></a>
      </li>

      <li>
        <a href="{% url 'group:schedules' %}"><i class="icon-tasks"></i> Schedules
          <i class="icon-chevron-right" style="float:right"></i></a>
      </li>
    </ul>
    <div class="row-fluid">
      <h4 class="sidebox-head">SCHEDULES</h4>
      <div class="span12 sidebox">
        
      </div> <!-- span10 -->
    </div> <!-- row -->
     <div class="row-fluid">
      <h4 class="sidebox-head">Members</h4>
      <div class="span12 sidebox">
          <ul>
            <li><a>{{ group.admin }}</a></li>
            {% for member in group.members.all %}
              <li><a>{{ member }}</a></li>
            {% endfor %}
          </ul>
      </div> <!-- span10 -->
    </div> <!-- row -->
  </div> <!-- span12 -->
</div> <!-- row -->
{% endblock sidebar %}

{% block main %}
<div class="row-fluid">
  <div class="span11 offset1">
    <div class="row-fluid">
      <div class="span12">
        <div class="top-quote">
          <blockquote>
            <b>Group Quote:</b>
            {% if group.quote %}
              <p>{{ group.quote.text }}</p>
              {% if group.quote.author %}
                <small>
                  {{ group.quote.author }}{% if group.quote.book %} ({{ group.quote.book }}){% endif %}
                </small>
              {% endif %}
              
              <a href="#"
                onclick="javascript:Dajaxice.darkoob.social.set_my_quote(
                set_my_quote_callback, {'quote_id': {{ group.quote.id }} })">
                <i data-toggle="tooltip" id="set_quote" class="icon-ok pull-right">
                </i>
              </a>
            {% endif %}
          </blockquote>
        </div> <!-- top-quote -->
      </div> <!-- span12 -->
    </div> <!-- row -->

    <div class="row-fluid">
      <div class="span12">
        <div class="details group-details">
          <div class="row-fluid">
            <div class="span2">
              <div class="thumb">
                {% if group.thumb %}
                  {% thumbnail group.thumb "100x100" crop="center" as im %}
                    <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}"/>
                  {% endthumbnail %}
                {% else %}
                  <img src="{% static "/static/img/default-group.jpg" %}" width="100" height="100"/>
                {% endif %}
              </div>
            </div>
            <div class="span10">
              <div class="row-fluid">
                <div class="span5">
                  <h4>{{ group.name }}</h4>
                </div>
                <div class="span1 offset5">
                  <button id="group-toggle-btn" class="btn btn-primary btn-mini"
                    onclick="Dajaxice.darkoob.group.group_toggle(group_toggle_cb,
                    {group_id: {{ group.id }},
                    user_id: {{ user.id }},
                    is_member: {% if is_member %}true{% else %}false{% endif %}})">
                    {% if is_member %}Leave{% else %}Join{% endif %}
                  </button>
                </div>
              </div>
                
              <div class="row-fluid stats">
                <div class="span10 offset2">
                  <div class="info-block"><a href="{% url 'group:members' %}">{{ group.members.all|length }} members</a></div>
                  <div class="info-block"><a href="{% url 'group:schedules' %}">{{ group.schedules|length }} schedules</a></div>
                  <div class="info-block"><a href="{% url 'group:schedules' %}">{{ group.deadlines|length }} deadlines</a></div>
                </div>
              </div>
            </div> <!-- span10 -->
          </div> <!-- row -->
        </div> <!-- details -->
      </div> <!-- span12 -->
    </div> <!-- row -->

    <div class="row-fluid">
      <div class="span1">
        <img class="new-post-icon new-post-icon-active" src="{% static "/static/img/Pen-black-32.png" %}" alt="Text"/>
        <img class="new-post-icon" src="{% static "/static/img/Quote-black-32.png" %}" alt="Quote"/>
        <img class="new-post-icon" src="{% static "/static/img/Cronometer-black-32.png" %}" alt="Deadline"/>
      </div>
      <div class="span11">
        <div class="sidebox">
          <div class="row-fluid">
            <div class="span9 new_post_container">
              <form method="post" action="{% url "social:new_post" %}">
                {% csrf_token %}
                {{ new_post_form.text }}
              </form>
            </div>
            <div class="span1 new_post_button">
              <button class="btn btn-inverse" onclick="Dajaxice.darkoob.social.submit_post(Dajax.process, {'text': $('#id_text').val()})">Post</button>
            </div>
          </div> <!-- row -->
        </div> <!-- sidebox -->
      </div> <!-- span11 -->
    </div> <!-- row -->

    <div class="row-fluid">
      <div class="span12">
        {% comment %}{% include "post/posts.html" %}{% endcomment %}
      </div> <!-- span12 -->
    </div> <!-- row -->
  </div> <!-- span -->
</div> <!-- row -->
{% endblock main %}

{% block bottom_js %}
{{ block.super }}
<script type="text/javascript" src="{% static "/static/js/group.js" %}"></script>
{% endblock bottom_js %}
